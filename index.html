<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Космический шутер</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            cursor: none;
        }
        #game {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-image: url('https://images.unsplash.com/photo-1506318137071-a8e063b4bec0?q=80&w=1000');
            background-size: cover;
            overflow: hidden;
        }
        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><polygon points="50,10 90,90 10,90" fill="lime"/></svg>');
            background-size: contain;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            transition: transform 0.1s;
        }
        .bullet {
            position: absolute;
            width: 8px;
            height: 20px;
            background-color: yellow;
            border-radius: 4px;
        }
        .enemy {
            position: absolute;
            width: 40px;
            height: 40px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="red"/></svg>');
            background-size: contain;
        }
        .explosion {
            position: absolute;
            width: 60px;
            height: 60px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="30" fill="orange"/><circle cx="50" cy="50" r="20" fill="yellow"/></svg>');
            background-size: contain;
            animation: explode 0.5s forwards;
        }
        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-family: 'Arial', sans-serif;
            font-size: 24px;
            text-shadow: 0 0 5px #00ff00;
        }
        #health {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-family: 'Arial', sans-serif;
            font-size: 24px;
            text-shadow: 0 0 5px #ff0000;
        }
        @keyframes explode {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background-color: white;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div id="game">
        <div id="player"></div>
        <div id="score">Очки: 0</div>
        <div id="health">Жизни: ❤️❤️❤️</div>
    </div>

    <script>
        const game = document.getElementById('game');
        const player = document.getElementById('player');
        const scoreElement = document.getElementById('score');
        const healthElement = document.getElementById('health');
        
        let score = 0;
        let health = 3;
        let playerX = window.innerWidth / 2;
        let bullets = [];
        let enemies = [];
        let explosions = [];
        let stars = [];
        let keys = {};
        let gameOver = false;
        let enemySpawnInterval;
        let starSpawnInterval;
        let gameLoopInterval;
        
        // Создаем звезды на фоне
        function createStars() {
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * window.innerWidth + 'px';
                star.style.top = Math.random() * window.innerHeight + 'px';
                star.style.opacity = Math.random();
                game.appendChild(star);
                stars.push({
                    element: star,
                    speed: 1 + Math.random() * 3
                });
            }
        }
        
        // Движение звезд (эффект полета)
        function moveStars() {
            stars.forEach(star => {
                let top = parseFloat(star.element.style.top);
                top += star.speed;
                if (top > window.innerHeight) {
                    top = 0;
                    star.element.style.left = Math.random() * window.innerWidth + 'px';
                }
                star.element.style.top = top + 'px';
            });
        }
        
        // Управление кораблем
        function handleInput() {
            const speed = 10;
            
            if (keys['ArrowLeft'] || keys['a']) {
                playerX = Math.max(25, playerX - speed);
            }
            if (keys['ArrowRight'] || keys['d']) {
                playerX = Math.min(window.innerWidth - 25, playerX + speed);
            }
            
            player.style.left = playerX + 'px';
        }
        
        // Выстрел
        function fire() {
            if (gameOver) return;
            
            const bullet = document.createElement('div');
            bullet.className = 'bullet';
            bullet.style.left = (playerX - 4) + 'px';
            bullet.style.bottom = '70px';
            game.appendChild(bullet);
            
            bullets.push({
                element: bullet,
                x: playerX - 4,
                y: window.innerHeight - 70
            });
        }
        
        // Движение пуль
        function moveBullets() {
            bullets.forEach((bullet, index) => {
                bullet.y -= 15;
                bullet.element.style.bottom = (window.innerHeight - bullet.y) + 'px';
                
                // Удаление пуль за пределами экрана
                if (bullet.y < 0) {
                    bullet.element.remove();
                    bullets.splice(index, 1);
                }
            });
        }
        
        // Создание врагов
        function spawnEnemy() {
            if (gameOver) return;
            
            const enemy = document.createElement('div');
            enemy.className = 'enemy';
            const x = Math.random() * (window.innerWidth - 40);
            enemy.style.left = x + 'px';
            enemy.style.top = '-40px';
            game.appendChild(enemy);
            
            enemies.push({
                element: enemy,
                x: x,
                y: -40,
                speed: 2 + Math.random() * 3
            });
        }
        
        // Движение врагов
        function moveEnemies() {
            enemies.forEach((enemy, enemyIndex) => {
                enemy.y += enemy.speed;
                enemy.element.style.top = enemy.y + 'px';
                
                // Проверка столкновения с игроком
                if (enemy.y + 40 > window.innerHeight - 50 && 
                    enemy.x + 20 > playerX - 25 && 
                    enemy.x < playerX + 25) {
                    
                    // Столкновение с игроком
                    createExplosion(enemy.x, enemy.y);
                    enemy.element.remove();
                    enemies.splice(enemyIndex, 1);
                    
                    health--;
                    updateHealth();
                    
                    if (health <= 0) {
                        gameOver = true;
                        endGame();
                    }
                    
                    return;
                }
                
                // Удаление врагов за пределами экрана
                if (enemy.y > window.innerHeight) {
                    enemy.element.remove();
                    enemies.splice(enemyIndex, 1);
                }
            });
        }
        
        // Проверка попаданий
        function checkHits() {
            bullets.forEach((bullet, bulletIndex) => {
                enemies.forEach((enemy, enemyIndex) => {
                    if (bullet.x + 4 > enemy.x && 
                        bullet.x < enemy.x + 40 && 
                        bullet.y < enemy.y + 40 && 
                        bullet.y + 20 > enemy.y) {
                        
                        // Попадание по врагу
                        createExplosion(enemy.x, enemy.y);
                        enemy.element.remove();
                        enemies.splice(enemyIndex, 1);
                        
                        bullet.element.remove();
                        bullets.splice(bulletIndex, 1);
                        
                        score += 100;
                        scoreElement.textContent = 'Очки: ' + score;
                        
                        return;
                    }
                });
            });
        }
        
        // Создание взрыва
        function createExplosion(x, y) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            game.appendChild(explosion);
            
            explosions.push({
                element: explosion,
                timer: setTimeout(() => {
                    explosion.remove();
                    explosions = explosions.filter(e => e.element !== explosion);
                }, 500)
            });
        }
        
        // Обновление здоровья
        function updateHealth() {
            let hearts = '';
            for (let i = 0; i < health; i++) {
                hearts += '❤️';
            }
            healthElement.textContent = 'Жизни: ' + hearts;
        }
        
        // Конец игры
        function endGame() {
            clearInterval(enemySpawnInterval);
            clearInterval(starSpawnInterval);
            clearInterval(gameLoopInterval);
            
            const gameOverDiv = document.createElement('div');
            gameOverDiv.style.position = 'absolute';
            gameOverDiv.style.top = '50%';
            gameOverDiv.style.left = '50%';
            gameOverDiv.style.transform = 'translate(-50%, -50%)';
            gameOverDiv.style.color = 'white';
            gameOverDiv.style.fontSize = '48px';
            gameOverDiv.style.textAlign = 'center';
            gameOverDiv.style.textShadow = '0 0 10px red';
            gameOverDiv.innerHTML = 'GAME OVER<br><span style="font-size: 24px">Ваш счет: ' + score + '</span>';
            
            game.appendChild(gameOverDiv);
        }
        
        // Инициализация игры
        function initGame() {
            createStars();
            updateHealth();
            
            // Обработчики событий
            document.addEventListener('keydown', (e) => {
                keys[e.key] = true;
                
                // Пробел для стрельбы
                if (e.key === ' ' && !gameOver) {
                    fire();
                }
            });
            
            document.addEventListener('keyup', (e) => {
                keys[e.key] = false;
            });
            
            // Клик/тап для стрельбы
            game.addEventListener('click', () => {
                if (!gameOver) fire();
            });
            
            // Интервалы игры
            enemySpawnInterval = setInterval(spawnEnemy, 1000);
            starSpawnInterval = setInterval(moveStars, 50);
            
            gameLoopInterval = setInterval(() => {
                if (gameOver) return;
                
                handleInput();
                moveBullets();
                moveEnemies();
                checkHits();
            }, 16); // ~60 FPS
        }
        
        // Запуск игры
        initGame();
    </script>
</body>
</html>
